# ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ìµœì í™” ì‚¬ìš© ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

- **ì‘ì„±ì¼**: 2024-12-27
- **ì‘ì„±ì**: AI Assistant
- **ë¬¸ì„œ ìœ í˜•**: ê¸°ìˆ  ê°€ì´ë“œ
- **ê´€ë ¨ íŒŒì¼**: [database_optimization_indexes.sql](database_optimization_indexes.sql)

## ğŸ¯ ëª©ì 

ì†Œë‹´(SODAM) í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•œ ì¸ë±ìŠ¤ ìƒì„± ë° ê´€ë¦¬ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“ ê´€ë ¨ íŒŒì¼

- **SQL ìŠ¤í¬ë¦½íŠ¸**: `docs/technical/database_optimization_indexes.sql`
- **MySQL ìµœì í™” ì „ëµ**: `docs/technical/MySQL_ë°ì´í„°ë² ì´ìŠ¤_ìµœì í™”_ì „ëµ_ë¬¸ì„œ.md`

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

```bash
# MySQL ì„œë²„ ì—°ê²° í™•ì¸
mysql -u [username] -p -h [host] [database_name]

# ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ
USE sodam;
```

### 2. ì¸ë±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
# SQL íŒŒì¼ ì‹¤í–‰
mysql -u [username] -p [database_name] < docs/technical/database_optimization_indexes.sql

# ë˜ëŠ” MySQL í´ë¼ì´ì–¸íŠ¸ì—ì„œ
source docs/technical/database_optimization_indexes.sql;
```

## ğŸ“Š ì¸ë±ìŠ¤ êµ¬ì„± í˜„í™©

### ğŸ” ìë™ ìƒì„± ì¸ë±ìŠ¤ (JPA @Index)

ë‹¤ìŒ ì¸ë±ìŠ¤ë“¤ì€ JPA ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ìë™ ìƒì„±ë©ë‹ˆë‹¤:

#### Users í…Œì´ë¸”

- `idx_user_email`: ì´ë©”ì¼ ê¸°ë°˜ ë¡œê·¸ì¸ ìµœì í™”
- `idx_user_grade`: ì‚¬ìš©ì ë“±ê¸‰ë³„ ì¡°íšŒ ìµœì í™”
- `idx_user_created_at`: ìƒì„±ì¼ ê¸°ë°˜ ì •ë ¬ ìµœì í™”

#### Store í…Œì´ë¸”

- `idx_store_business_number`: ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ ê²€ìƒ‰ ìµœì í™”
- `idx_store_code`: ë§¤ì¥ ì½”ë“œ ê²€ìƒ‰ ìµœì í™”
- `idx_store_name`: ë§¤ì¥ëª… ê²€ìƒ‰ ìµœì í™”
- `idx_store_location`: ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰ ìµœì í™” (latitude, longitude)
- `idx_store_created_at`: ìƒì„±ì¼ ì •ë ¬ ìµœì í™”
- `idx_store_updated_at`: ìˆ˜ì •ì¼ ì •ë ¬ ìµœì í™”

#### Employee_Profile í…Œì´ë¸”

- `idx_employee_number`: ì‚¬ì›ë²ˆí˜¸ ê²€ìƒ‰ ìµœì í™”
- `idx_employee_user_id`: User ID ì™¸ë˜í‚¤ ìµœì í™”
- `idx_employee_weekly_allowance`: ì£¼íœ´ìˆ˜ë‹¹ ê³„ì‚° ìµœì í™”

#### Employee_Store_Relation í…Œì´ë¸”

- `idx_employee_store`: ì§ì›-ë§¤ì¥ ì¡°í•© ì¡°íšŒ ìµœì í™”
- `idx_employee_id`: ì§ì›ë³„ ì¡°íšŒ ìµœì í™”
- `idx_store_id`: ë§¤ì¥ë³„ ì¡°íšŒ ìµœì í™”
- `idx_hire_date`: ì…ì‚¬ì¼ ê¸°ë°˜ ì¡°íšŒ ìµœì í™”
- `idx_wage_settings`: ê¸‰ì—¬ ì„¤ì • ì¡°íšŒ ìµœì í™”

#### Attendance í…Œì´ë¸”

- `idx_attendance_employee_id`: ì§ì›ë³„ ì¶œí‡´ê·¼ ê¸°ë¡ ì¡°íšŒ
- `idx_attendance_store_id`: ë§¤ì¥ë³„ ì¶œí‡´ê·¼ ê¸°ë¡ ì¡°íšŒ
- `idx_attendance_check_in_time`: ì¶œê·¼ ì‹œê°„ ê¸°ë°˜ ì¡°íšŒ
- `idx_attendance_check_out_time`: í‡´ê·¼ ì‹œê°„ ê¸°ë°˜ ì¡°íšŒ
- `idx_attendance_employee_store`: ì§ì›-ë§¤ì¥ ì¡°í•© ì¡°íšŒ
- `idx_attendance_date_range`: ë‚ ì§œ ë²”ìœ„ ì¡°íšŒ ìµœì í™”

### âš¡ ì¶”ê°€ ì„±ëŠ¥ ìµœì í™” ì¸ë±ìŠ¤ (ìˆ˜ë™ ìƒì„±)

ë‹¤ìŒ ì¸ë±ìŠ¤ë“¤ì€ SQL ìŠ¤í¬ë¦½íŠ¸ë¡œ ìˆ˜ë™ ìƒì„±ë©ë‹ˆë‹¤:

```sql
-- ì›”ë³„ ê¸‰ì—¬ ê³„ì‚° ìµœì í™”
idx_attendance_monthly_calc (employee_id, store_id, checkInTime, checkOutTime)

-- ì¼ë³„ í†µê³„ ìµœì í™”
idx_attendance_daily_stats (store_id, DATE(checkInTime))

-- ì£¼íœ´ìˆ˜ë‹¹ ì¡°íšŒ ìµœì í™” (ì¡°ê±´ë¶€ ì¸ë±ìŠ¤)
idx_attendance_weekly_allowance (employee_id, store_id, weeklyAllowance) WHERE weeklyAllowance IS NOT NULL

-- ë¯¸ì™„ë£Œ ì¶œê·¼ ê¸°ë¡ ìµœì í™” (ì¡°ê±´ë¶€ ì¸ë±ìŠ¤)
idx_attendance_incomplete (employee_id, checkInTime) WHERE checkOutTime IS NULL
```

## ğŸ”§ ì¸ë±ìŠ¤ ê´€ë¦¬ ëª…ë ¹ì–´

### ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸

```sql
-- ëª¨ë“  í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ í™•ì¸
SHOW INDEX FROM users;
SHOW INDEX FROM store;
SHOW INDEX FROM employee_profile;
SHOW INDEX FROM employee_store_relation;
SHOW INDEX FROM attendance;

-- ì¸ë±ìŠ¤ ì‚¬ìš©ë¥  í™•ì¸
SELECT 
    TABLE_NAME,
    INDEX_NAME,
    CARDINALITY,
    INDEX_TYPE
FROM information_schema.STATISTICS 
WHERE TABLE_SCHEMA = DATABASE() 
AND TABLE_NAME IN ('users', 'store', 'employee_profile', 'employee_store_relation', 'attendance')
ORDER BY TABLE_NAME, INDEX_NAME;
```

### í…Œì´ë¸” í¬ê¸° ë° ì„±ëŠ¥ ë¶„ì„

```sql
-- í…Œì´ë¸” ë° ì¸ë±ìŠ¤ í¬ê¸° í™•ì¸
SELECT 
    TABLE_NAME,
    ROUND(((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024), 2) AS 'Total Size (MB)',
    ROUND((DATA_LENGTH / 1024 / 1024), 2) AS 'Data Size (MB)',
    ROUND((INDEX_LENGTH / 1024 / 1024), 2) AS 'Index Size (MB)',
    TABLE_ROWS
FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = DATABASE() 
AND TABLE_NAME IN ('users', 'store', 'employee_profile', 'employee_store_relation', 'attendance')
ORDER BY (DATA_LENGTH + INDEX_LENGTH) DESC;
```

### ì¿¼ë¦¬ ì„±ëŠ¥ ë¶„ì„

```sql
-- ì¿¼ë¦¬ ì‹¤í–‰ ê³„íš í™•ì¸ (ì˜ˆì‹œ)
EXPLAIN SELECT a.* 
FROM attendance a 
WHERE a.employee_id = 1 
AND a.checkInTime BETWEEN '2024-12-01 00:00:00' AND '2024-12-31 23:59:59'
ORDER BY a.checkInTime DESC;
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™” íš¨ê³¼

### ì˜ˆìƒ ì„±ëŠ¥ ê°œì„ 

1. **ì§ì›ë³„ ì›”ê°„ ì¶œê·¼ ê¸°ë¡ ì¡°íšŒ**: 90% ì„±ëŠ¥ í–¥ìƒ
2. **ë§¤ì¥ë³„ ì¼ì¼ í†µê³„**: 85% ì„±ëŠ¥ í–¥ìƒ
3. **ì‚¬ìš©ì ë¡œê·¸ì¸**: 95% ì„±ëŠ¥ í–¥ìƒ
4. **ê¸‰ì—¬ ê³„ì‚° ì¿¼ë¦¬**: 80% ì„±ëŠ¥ í–¥ìƒ
5. **ìœ„ì¹˜ ê¸°ë°˜ ë§¤ì¥ ê²€ìƒ‰**: 75% ì„±ëŠ¥ í–¥ìƒ

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

- **ì˜ˆìƒ ì¸ë±ìŠ¤ í¬ê¸°**: ì „ì²´ ë°ì´í„°ì˜ 15-20%
- **ë©”ëª¨ë¦¬ ìš”êµ¬ì‚¬í•­**: ìµœì†Œ 512MB ì¶”ê°€ ê¶Œì¥

## ğŸ› ï¸ ìœ ì§€ë³´ìˆ˜ ê°€ì´ë“œ

### ì •ê¸° ìœ ì§€ë³´ìˆ˜ (ì›” 1íšŒ)

```sql
-- ì¸ë±ìŠ¤ í†µê³„ ì—…ë°ì´íŠ¸
ANALYZE TABLE users, store, employee_profile, employee_store_relation, attendance;

-- í…Œì´ë¸” ìµœì í™” (í•„ìš”ì‹œ)
OPTIMIZE TABLE users, store, employee_profile, employee_store_relation, attendance;
```

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```sql
-- ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì¸ë±ìŠ¤ í™•ì¸ (MySQL 8.0+)
SELECT * FROM sys.schema_unused_indexes WHERE object_schema = DATABASE();

-- ì¤‘ë³µ ì¸ë±ìŠ¤ í™•ì¸
SELECT * FROM sys.schema_redundant_indexes WHERE table_schema = DATABASE();
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ì¸ë±ìŠ¤ ìƒì„± ì‹œ

1. **ëŒ€ìš©ëŸ‰ í…Œì´ë¸”**: ì¸ë±ìŠ¤ ìƒì„± ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤
2. **ì„œë¹„ìŠ¤ ì¤‘ë‹¨**: ê°€ëŠ¥í•˜ë©´ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì‹œê°„ì— ì‹¤í–‰í•˜ì„¸ìš”
3. **ë””ìŠ¤í¬ ê³µê°„**: ì¶©ë¶„í•œ ë””ìŠ¤í¬ ê³µê°„ì„ í™•ë³´í•˜ì„¸ìš”
4. **ë°±ì—…**: ì¸ë±ìŠ¤ ìƒì„± ì „ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…ì„ ê¶Œì¥í•©ë‹ˆë‹¤

### ìš´ì˜ í™˜ê²½ ì ìš©

```bash
# 1. ë°±ì—… ìƒì„±
mysqldump -u [username] -p [database_name] > backup_before_index.sql

# 2. ì¸ë±ìŠ¤ ìƒì„± (ë‹¨ê³„ë³„ ì‹¤í–‰ ê¶Œì¥)
mysql -u [username] -p [database_name] < docs/technical/database_optimization_indexes.sql

# 3. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
# ì‹¤ì œ ì¿¼ë¦¬ë¡œ ì„±ëŠ¥ ê°œì„  í™•ì¸

# 4. ëª¨ë‹ˆí„°ë§
# ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
```

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ë¬¸ì œì™€ í•´ê²°ë°©ë²•

#### 1. ì¸ë±ìŠ¤ ìƒì„± ì‹¤íŒ¨

```sql
-- ì˜¤ë¥˜ í™•ì¸
SHOW WARNINGS;

-- í…Œì´ë¸” ì ê¸ˆ í™•ì¸
SHOW PROCESSLIST;

-- ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
SELECT 
    table_schema AS 'Database',
    ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS 'Size (MB)'
FROM information_schema.tables
GROUP BY table_schema;
```

#### 2. ì„±ëŠ¥ ê°œì„ ì´ ì—†ëŠ” ê²½ìš°

```sql
-- ì¿¼ë¦¬ ì‹¤í–‰ ê³„íš ì¬í™•ì¸
EXPLAIN [your_query];

-- ì¸ë±ìŠ¤ ì‚¬ìš©ë¥  í™•ì¸
SHOW STATUS LIKE 'Handler_read%';

-- í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸
ANALYZE TABLE [table_name];
```

#### 3. ë©”ëª¨ë¦¬ ë¶€ì¡±

```sql
-- í˜„ì¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
SHOW STATUS LIKE 'Innodb_buffer_pool%';

-- ì„¤ì • í™•ì¸
SHOW VARIABLES LIKE 'innodb_buffer_pool_size';
```

## ğŸ“š ì¶”ê°€ ìë£Œ

### ê´€ë ¨ ë¬¸ì„œ

- [MySQL ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” ì „ëµ ë¬¸ì„œ](MySQL_ë°ì´í„°ë² ì´ìŠ¤_ìµœì í™”_ì „ëµ_ë¬¸ì„œ.md)
- [4ë‹¨ê³„ ì„±ëŠ¥ ìµœì í™” ì‘ì—… ê³„íš](../project-management/ì‘ì—…_ê³„íš_ë°_ì²´í¬ë¦¬ìŠ¤íŠ¸.md#4ë‹¨ê³„-ì„±ëŠ¥-ìµœì í™”)

### ì™¸ë¶€ ì°¸ê³  ìë£Œ

- [MySQL 8.0 Reference Manual - Optimization](https://dev.mysql.com/doc/refman/8.0/en/optimization.html)
- [MySQL Performance Tuning Guide](https://dev.mysql.com/doc/refman/8.0/en/optimization-indexes.html)

## ğŸ“ ì§€ì›

### ë¬¸ì œ ë°œìƒ ì‹œ ì—°ë½ì²˜

- **ê°œë°œíŒ€**: ë‚´ë¶€ ì´ìŠˆ íŠ¸ë˜ì»¤ ì‹œìŠ¤í…œ í™œìš©
- **ê¸´ê¸‰ ìƒí™©**: ì‹œìŠ¤í…œ ê´€ë¦¬ìì—ê²Œ ì¦‰ì‹œ ì—°ë½

### ë¡œê·¸ ìˆ˜ì§‘

```bash
# MySQL ì—ëŸ¬ ë¡œê·¸ í™•ì¸
tail -f /var/log/mysql/error.log

# ìŠ¬ë¡œìš° ì¿¼ë¦¬ ë¡œê·¸ í™•ì¸
tail -f /var/log/mysql/slow.log
```

---

## ğŸ“… ë³€ê²½ ì´ë ¥

| ë‚ ì§œ         | ë²„ì „  | ë³€ê²½ ë‚´ìš© | ì‘ì„±ì          |
|------------|-----|-------|--------------|
| 2024-12-27 | 1.0 | ì´ˆê¸° ì‘ì„± | AI Assistant |

---

**ì°¸ê³ **: ì´ ê°€ì´ë“œëŠ” ì†Œë‹´(SODAM) í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹¤ì œ ìš´ì˜ í™˜ê²½ì— ì ìš©í•˜ê¸° ì „ì— ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì¶©ë¶„í•œ ê²€ì¦ì„ ìˆ˜í–‰í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
